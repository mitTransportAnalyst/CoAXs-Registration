<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>CoAXs Registration Test Form</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link href="https://developers.google.com/maps/documentation/javascript/examples/default.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,800,600' rel='stylesheet' type='text/css'>
 
    <!-- Latest compiled and minified JavaScript -->    
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>


    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>

    <style type="text/css">
        

        #map_canvas {
            position: ;
            width: 75%;
            height: 500px;
            margin-top: 10px;
            margin-bottom: 10px;
        }
        
        #current {
            padding-top: 25px;
        }
        
        ul {
            list-style-type: none;
        }

        body {
            margin-left: 10px;
            margin-right: 10px;
            background-color: yellow;
            font-family: 'Open Sans', sans-serif;
        }

        h3 {
            font-weight: 300;
        }

        #dataVizSlider {
          width: 300px;
        }

        #brtSlider {
          width: 300px;
        }

        #form-submit {
            position: 50%;
            font-weight: 300;
            font-size: 1.5em;
            background-color: gray;
            color: none;
            border-style: none;
        }

    </style>


</head>

<body>
    
    <form class="form-horizontal" id="input-form" action="" method="POST" target="no-target">
        
        <div class="form-group form-group-lg" style="padding:10px">
          <label class="col-sm-1 control-label" for="formGroupInputLarge" style="text-align:left">Initials:</label>
          <div class="col-sm-2">    
            <input class="form-control" id="initials" type="text" name="initials" >
          </div>
        </div>
      <div class="form-group form-group-lg" style="padding:10px">
       <label class="col-sm-1 control-label" for="formGroupInputLarge" style="text-align:left">Places:</label>
        <div class="col-sm-10">     
        <div class="" id="btn-group"  role="group" aria-label="...">
          <input type="button" class="btn btn-success btn-lg poi" value="HOME">
          <input type="button" class="btn btn-success btn-lg poi" value="WORK">
          <input type="button" class="btn btn-success btn-lg poi" value="SHOPPING">
          <input type="button" class="btn btn-success btn-lg poi" value="SCHOOL">
          <input type="button" class="btn btn-success btn-lg poi" value="RECREATION">
          <input type="button" class="btn btn-success btn-lg poi" value="HEALTHCARE">
        </div>
        </div>
        </div>

  
      <div id='map_canvas'></div>
      <br>

      
      <span> 
        <button id="form-submit" class="btn btn-lg btn-success btn-block" type="submit" style="width:75%">SUBMIT</button>
      </span>
      

      </form>
      <br>

<!-- Form Script -->
      
    <script>
        $('#input-form').one('submit',function(){
            
            // var latitude = encodeURIComponent($('#latitude').val());
            // var longitude = encodeURIComponent($('#longitude').val());
            
            var background = encodeURIComponent($('#background').val());
                    
            // var poiTag = encodeURIComponent($('#poiTag').val());

            var initials = encodeURIComponent($('#initials').val());
            var initialsCol = "entry.1710541390";
            
            var poi = JSON.stringify(markers);
            var poiCol = "entry.1709971823";
            
            //var latCol = "";
            //var longCol = "entry.897103553";

       
            var baseURL = 'https://docs.google.com/forms/d/1PrYVTmEaW1UmN5Rx5121VpGnEDne0AT6UWcVzP6B2AE/formResponse?';
            var submitRef = '&submit=Submit';
            var submitURL = (baseURL + initialsCol + "=" + initials + "&" + poiCol + "=" + poi + "&" + submitRef);
            console.log(submitURL);
            $(this)[0].action=submitURL;
            $('#input-name').addClass('active').val('Thank You!');
        });
    

     var poiTag = [];
     var timeTag = [];
     var durationTag = [];
     var modeTag = [];
     var painTag = [];
     var markers = [];

        function initialize() {
            var mapOptions = {
              zoom: 13,
              center: new google.maps.LatLng(42.3385, -71.0809),
              mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById('map_canvas'),
                mapOptions);

            $('.poi').click(function() {
                poiTag = this.value;
                console.log('button clicked', this.value);
              });

            $('.time').click(function() {
                timeTag = this.value;
                console.log('button clicked', this.value);
              });

            $('.mode').click(function() {
                modeTag = this.value;
                console.log('button clicked', this.value);
              });

            // $('.duration').onchange(function() {
            //     durationTag = this.value;
            //     console.log('button clicked', this.value);
            //   });

            // $('.pain').(function() {
            //     painTag = this.value;
            //     console.log('button clicked', this.value);
            //   });


            google.maps.event.addListener(map, 'click', function(e) {
              placeMarker(e.latLng, map);
              
              console.log(e.latLng);
              // markers.push({"lat": e.latLng.A, "lng": e.latLng.F, "poiTag": $("#poiTag").val()});

              markers.push({"lat": e.latLng.H, "lng": e.latLng.L, "poiTag": poiTag, "timeTag": timeTag, "modeTag": modeTag});

                console.log(markers);
            });
        }

 function placeMarker(position, map) {
            var marker = new google.maps.Marker({
              position: position,
              map: map,
              draggable: true
            });
			google.maps.event.addListener(marker, 'dragstart', function(e) { 
				for(var i=0; i<markers.length; i++) {
					if(markers[i].lat == marker.position.H) {
						console.log(markers[i].lat + ' ' + markers[i].lng);
						if(markers[i].lng == marker.position.L){
							markers.splice(i, 1);
							break;
						}
					}
				}
			});
			google.maps.event.addListener(marker, 'dragend', function(e) { 
				markers.push({"lat": e.latLng.H, "lng": e.latLng.L, "poiTag": poiTag, "timeTag": timeTag, "modeTag": modeTag});
			});
			google.maps.event.addListener(marker, 'click', function() { 
			    for(var i=0; i<markers.length; i++) {
					if(markers[i].lat == marker.position.H) {
						console.log(markers[i].lat + ' ' + markers[i].lng);
						if(markers[i].lng == marker.position.L){
							markers.splice(i, 1);
							break;
						}
					}
				}
				marker.setMap(null);
			});
		}

        google.maps.event.addDomListener(window, 'load', initialize);
    

      // $('.btn').click(function() {
      //   var btnTag = this.value;
      //   console.log('button clicked', this.value);

      // });

     

      $(function() {
        $( "#dataVizSlider" ).slider({
          value:3,
          min: 1,
          max: 5,
          step: 1,
          slide: function( event, ui ) {
            $( "#amount" ).val( ui.value );
          }
        });
        $( "#amount" ).val( $( "#slider" ).slider( "value" ) );
      });

      $(function() {
        $( "#brtSlider" ).slider({
          value:3,
          min: 1,
          max: 5,
          step: 1,
          slide: function( event, ui ) {
            $( "#amount" ).val( ui.value );
          }
        });
        $( "#amount" ).val( $( "#slider" ).slider( "value" ) );
      });

    </script>


</body>
</html>




